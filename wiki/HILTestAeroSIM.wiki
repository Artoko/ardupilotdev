#summary Testing the firmware in Hil mode with AeroSIM-RC.
#labels Featured

= Introduction =

Here you will find a good and cheap method to test yourself  the [http://code.google.com/p/arducopter/ ArduCopter] firmware in HIL (Hardware In the Loop) mode with the [http://www.aerosimrc.com/j/index.php/en AeroSIM-RC simulator].

http://ardupilotdev.googlecode.com/svn/images/AeroSimRC_HIL.jpg

== Details ==
*Hardware requirement:*
 * a PC computer,
 * an !ArduMega board APMv1 (1280, 2560)or APMv2,for the APMv1, no IMU shield is required (more info [http://code.google.com/p/ardupilot-mega/ HERE]),
 * the [http://www.aerosimrc.com/j/index.php/en/downloads AeroSIM-RC v3.81] simulator (Demo or Retail version),
 * the firmware [http://ardupilotdev.googlecode.com/files/ArduCopter22b2xp.zip ArduCopter v2.2 b2xp] or more installed on the APM,
 * the [http://code.google.com/p/ardupilot-mega/downloads/list Mission Planner v1.1.20] (or more) installed on the PC, you may download the latest version in the [http://code.google.com/p/ardupilot-mega/source/browse/ Ardupilot-mega official repository] with GIT
 * the [http://ardupilotdev.googlecode.com/files/ArduCopter_HIL_setups.zip HIL setups and param files] for the HIL simulation
 * the !AeroSim plug-in (plugin_AeroSIMRC.dll) from the zip file AeroSimRCAPMHil.zip which can be found in the mission panner folder.

== Installation ==

 # Unzip the archive AeroSimRCAPMHil.zip
 # copy the folder \APMHill in the AeroSiM folder c:\Program Files (x86)\Plugin\
 # check that in the firmware the parameters of the APM_Config.h are set:

{{{
  #define HIL_MODE 	HIL_MODE_ATTITUDE
  #define X_PLANE 	ENABLED
}}}

4) upload the AeroSimPID.param (found in the ArduCopter_HIL_setups\AeroSim_Hill folder ) with the mission planner to your APM board.

http://ardupilotdev.googlecode.com/svn/images/AC22b2xp_PID_HIL_AeroSim.jpg

== Testing ==

http://ardupilotdev.googlecode.com/svn/images/AC22b2xp_AeroSIMRCsetup.jpg

 * launch the APM mission planner
 * click on the Tab *simulation*
 * click on *CONNECT* on the top right corner
 * click on the button *!AeroSim*
 * click on *Start simulation*
 * launch the *AeroSIM-RC* then select *Plugin* and *APMHil*
 * select the model *Quad-IV* 
 * with the windows !NotePad open the launch script *scriptRTL_ !Land_Test.txt*
 * select all the text and then copy in into the clipboard ctrl-c.
 * on the main windows of the mission planner, click on the button *script* then paste the clipboard ctrl-p and close the window script. Clic to Yes when you see *Run Script*

If all is ok, you will see the quadcopter flying in a full autonomous flight on a simple 2 minutes mission...

You will find a video of this simple mission at: [http://vimeo.com/35097058]

More infos at:
[http://diydrones.com/profile/JeanLouisNaudin]

Enjoy with the HIL simulation with *AeroSIM-RC*...

Regards, 
Jean-Louis